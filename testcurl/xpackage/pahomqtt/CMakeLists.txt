cmake_minimum_required(VERSION 3.10)

include(${CMAKE_CURRENT_LIST_DIR}/../xpackage.cmake)

set(XPACKAGE_NAME pahomqtt)
set(XPACKAGE_VERSION 1.3.2)
set(XPACKAGE_URL https://github.com/eclipse/paho.mqtt.c/archive/v1.3.2.zip)
set(XPACKAGE_HASH SHA256=8BB7A0C2CFBB72827B6C343B40213E7C787D329A3C3642DC9D99FBF2554ECBEA)

set(XPACKAGE_SOURCE_DIR paho.mqtt.c-${XPACKAGE_VERSION}/src)
set(XPACKAGE_SOURCE_GLOB *.c)
set(XPACKAGE_SOURCE_EXCLUDES .*/samples/.* .*/test/.* )
set(XPACKAGE_INCLUDES ${XPACKAGE_SOURCE_DIR})
if(DEFINED USE_OPENSSL)
set(XPACKAGE_FLAGS -DOPENSSL=1 -DPAHO_MQTT_STATIC=1)
set(XPACKAGE_DEPENDS openssl)
else()
set(XPACKAGE_FLAGS -DPAHO_MQTT_STATIC=1)
set(XPACKAGE_DEPENDS )
endif()

set(XPACKAGE_EXPORT_INCLUDES ${XPACKAGE_SOURCE_DIR})
set(XPACKAGE_EXPORT_FLAGS -DPAHO_MQTT_STATIC=1)
if(${WIN32})
	set(XPACKAGE_EXPORT_LIBS ws2_32 crypt32 rpcrt4)
else()
	set(XPACKAGE_EXPORT_LIBS pthread)
endif()

xpackage_init()

